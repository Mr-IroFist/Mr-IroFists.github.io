<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Mr-IroFist"><meta name="keywords" content="前端"><meta name="description" content="前端的小知识，游戏经验分享，博主的日常小彩蛋"><link rel="alternative" href="/atom.xml" title="铁拳先生的 Blog" type="application/atom+xml"><link rel="icon" href="/img/拳击.png"><title>TypeScript泛型 - 铁拳先生的 Blog</title>
<link rel="stylesheet" href="../../../../css/main.css">

<link rel="stylesheet" href="../../../../js/fancybox/jquery.fancybox.min.css">
<!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]-->
<script src="../../../../js/jquery-3.1.1.min.js"></script>

<script src="../../../../js/fancybox/jquery.fancybox.min.js"></script>
<meta name="generator" content="Hexo 5.4.0"></head><body style="opacity:0"><header class="head"><h1 class="head-title u-fl"><a href="/">铁拳先生的 Blog</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="../../../../tags">标签</a></li><li class="head-nav__item"><a class="head-nav__link" href="../../../../archives">前端</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time class="post__time" datetime="2021-06-04T14:00:59.000Z">2021 - 06 - 04 22:00:59</time><h1 class="post__title"><a href="">TypeScript泛型</a></h1><div class="post__main echo"><h1 id="一、泛型是什么"><a href="#一、泛型是什么" class="headerlink" title="一、泛型是什么"></a>一、泛型是什么</h1><p>软件工程中，我们不仅要创建一致的定义良好的 API，同时也要考虑可重用性。 组件不仅能够支持当前的数据类型，同时也能支持未来的数据类型，这在创建大型系统时为你提供了十分灵活的功能。</p>
<p><strong>在像 C# 和 Java 这样的语言中，可以使用泛型来创建可重用的组件，一个组件可以支持多种类型的数据。 这样用户就可以用自己的数据类型来使用组件。</strong></p>
<p>设计泛型的关键目的是在成员之间提供有意义的约束，这些成员可以是：类的实例成员、类的方法、函数参数和函数返回值。</p>
<p>为了便于大家更好地理解上述的内容，我们来举个例子，在这个例子中，我们将一步步揭示泛型的作用。首先我们来定义一个通用的 <font color='#ff502c'>identity</font> 函数，该函数接收一个参数并直接返回它：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">identity</span>(<span class="hljs-params">value</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> value;<br>&#125;<br><br><span class="hljs-keyword">const</span> newValue = identity(<span class="hljs-number">1</span>);<br><span class="hljs-built_in">console</span>.log(newValue); <span class="hljs-comment">// 1</span><br></code></pre></td></tr></table></figure>

<p>现在，我们将 <font color='#ff502c'>identity</font> 函数做适当的调整，以支持 TypeScript 的 Number 类型的参数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">identity</span>(<span class="hljs-params">value: number</span>): <span class="hljs-title">Number</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> value;<br>&#125;<br><br><span class="hljs-built_in">console</span>.log(identity(<span class="hljs-number">1</span>)); <span class="hljs-comment">// 1</span><br></code></pre></td></tr></table></figure>

<p>这里 <font color='#ff502c'>identity</font> 的问题是我们将 <font color='#ff502c'>Number</font> 类型分配给参数和返回类型，使函数仅可用于该原始类型。但该函数并不是可扩展或通用的，很明显这并不是我们所希望的。</p>
<p>我们确实可以把 <font color='#ff502c'>Number</font> 换成 <font color='#ff502c'>any</font>,我们失去了定义应该返回哪种类型的能力，并且在这个过程中使编译器失去了类型保护的作用。我们的目标是让 <font color='#ff502c'>identity</font> 函数可以适用于任何特定的类型，为了实现这个目标，我们可以使用泛型来解决这个问题，具体实现方式如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">identity</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">value: T</span>): <span class="hljs-title">T</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> value;<br>&#125;<br><br><span class="hljs-built_in">console</span>.log(identity &lt; <span class="hljs-built_in">Number</span> &gt; <span class="hljs-number">1</span>); <span class="hljs-comment">// 1</span><br></code></pre></td></tr></table></figure>

<p>对于刚接触 TypeScript 泛型，首次看到<font color='#ff502c'> <code>&lt;T&gt;</code> </font> 语法会感到陌生。但是不用担心，就像传递参数一样，我们传递了我们想要用于特定函数调用的类型。<br><img src="https://user-gold-cdn.xitu.io/2020/6/10/1729b3d9774a21ac?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Alt text"><br>参考上面的图片，当我们调用 <font color='#ff502c'> <code>identity&lt;Number&gt;(1)</code> </font>，<font color='#ff502c'>Number </font> 类型就像参数 1 一样，它将在出现<font color='#ff502c'>T</font> 的任何位置填充该类型。图中<font color='#ff502c'> <code>&lt;T&gt;</code> </font> 内部的<font color='#ff502c'>T</font> 被称为类型变量，它是我们希望传递给 <font color='#ff502c'>identity</font> 函数的类型占位符，同时它被分配给 <font color='#ff502c'>value</font> 参数用来代替它的类型：此时 <font color='#ff502c'>T</font> 充当的是类型，而不是特定的 Number 类型。</p>
<p>其中<font color='#ff502c'>T</font> 代表 <strong>Type</strong>,在定义泛型时通常用作第一个类型变量名称。但实际上<font color='#ff502c'>T</font>可以用任何有效名称替代。除了<font color='#ff502c'>T</font>之外，以下是常见泛型变量代表的意思：</p>
<ul>
<li>K（Key）：表示对象中的键类型；</li>
<li>V（Value）：表示对象中的值类型；</li>
<li>V（Value）：表示对象中的值类型；</li>
</ul>
<p>其实并不是只能定义一个类型变量，我们可以引入希望定义的任何数量的类型变量。比如我们引入一个新的类型变量 <font color='#ff502c'>U</font>，用于扩展我们定义的<font color='#ff502c'>identity</font>函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">identity</span>&lt;<span class="hljs-title">T</span>, <span class="hljs-title">U</span>&gt;(<span class="hljs-params">value: T, message: U</span>): <span class="hljs-title">T</span> </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(message);<br>  <span class="hljs-keyword">return</span> value;<br>&#125;<br><br><span class="hljs-built_in">console</span>.log(identity &lt; <span class="hljs-built_in">Number</span>, string &gt; (<span class="hljs-number">68</span>, <span class="hljs-string">&quot;Semlinker&quot;</span>));<br></code></pre></td></tr></table></figure>

<p><img src="https://user-gold-cdn.xitu.io/2020/6/10/1729b3dbccc38ea7?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Alt text"></p>
<p>除了为类型变量显式设定值之外，一种更常见的做法是使编译器自动选择这些类型，从而使代码更简洁。我们可以完全省略尖括号，比如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">identity</span>&lt;<span class="hljs-title">T</span>, <span class="hljs-title">U</span>&gt;(<span class="hljs-params">value: T, message: U</span>): <span class="hljs-title">T</span> </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(message);<br>  <span class="hljs-keyword">return</span> value;<br>&#125;<br><br><span class="hljs-built_in">console</span>.log(identity(<span class="hljs-number">68</span>, <span class="hljs-string">&quot;Semlinker&quot;</span>));<br></code></pre></td></tr></table></figure>
</div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a class="post__tag__link" href="../../../../tags/TypeScript/">TypeScript</a></li><li class="post__tag__item"><a class="post__tag__link" href="../../../../tags/%E6%B3%9B%E5%9E%8B/">泛型</a></li></ul></footer></article></main><footer class="foot"><div class="foot-copy">&copy; 2016 - 2021 Mr-IroFist</div></footer>
<script src="../../../../js/scroller.js"></script>

<script src="../../../../js/main.js"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/01/assets/haru01.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>